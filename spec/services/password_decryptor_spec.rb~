require	'spec_helper'

describe PasswordEncryptor do

	describe "#encrypt" do

		it "returns password hash" do
			PasswordEncryptor.encrypt("test").should have_key(:hash)
		end

		it "returns password salt" do
			PasswordEncryptor.encrypt("test").should have_key(:salt)
		end

		it "generates hashes" do
			encryptor = mock("encryptor")
			PasswordEncryptor.stub :encryptor => encryptor
		end

	end

	describe "#encryptor" do
		it "delegates to Digest::SHA1" do
			PasswordEncryptor.encryptor.should be(Digest::SHA1)
		end
	end
end
